SHELL = /bin/sh
LIB_DIR = /opt/librga_linux/lib/
BIN_DIR = /opt/librga_linux/bin/
OBJECT_DIR = /opt/librga_linux/obj/
APP_DIR = /opt/librga_linux/

$(shell mkdir -p ${LIB_DIR})
$(shell mkdir -p ${BIN_DIR})
$(shell mkdir -p ${OBJECT_DIR})

#****************************************************************************

CC = g++
SHARED = -shared -o
FPIC = -fPIC -c
SRC_OBJECT = $(APP_DIR)RockchipRga.cpp $(APP_DIR)normal/NormalRga.cpp $(APP_DIR)normal/NormalRgaApi.cpp
H_OBJECT = $(APP_DIR)rga.h $(APP_DIR)RgaApi.h $(APP_DIR)RockchipRga.h $(APP_DIR)drmrga.h $(APP_DIR)NormalRga.h $(APP_DIR)NormalRgaContext.h
OBJECT = RockchipRga.o NormalRga.o NormalRgaApi.o
#DY_SRC_OBJECT = $(APP_DIR)test.c
#DY_OBJECT=test.o

LIB_OBJECT = librga.so
#BIN_OBJECT = 

#****************************************************************************
.PHONY:all

all:$(LIB_OBJECT) $(BIN_OBJECT)

$(LIB_OBJECT):$(OBJECT)
	$(CC) $(OBJECT) $(SHARED) -fPIC -o $(LIB_OBJECT)
	mv $(LIB_OBJECT) $(LIB_DIR)

$(OBJECT):$(SRC_OBJECT) $(H_OBJECT)
	$(CC) $(FPIC) $(SRC_OBJECT)

$(BIN_OBJECT):$(DY_OBJECT)
	$(CC) $(OBJECT_DIR)$(DY_OBJECT) -L$(LIB_DIR) -ltest -o $(BIN_OBJECT)
	mv $(BIN_OBJECT) $(BIN_DIR)

$(DY_OBJECT):$(DY_SRC_OBJECT)
	$(CC) -c $(DY_SRC_OBJECT)
	mv $(OBJECT) $(DY_OBJECT) $(OBJECT_DIR)

clean:
	rm -f $(OBJECT) $(TARGET) $(LIB_OBJECT)
